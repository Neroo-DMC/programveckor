<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uppgiftslista</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <h2>Lägg till uppgift</h2>
    <form id="taskForm">
        <label>Ämne: </label>
        <input type="text" id="subject" required>
        <br>

        <label>Inlämningsdatum: </label>
        <input type="date" id="dueDate" required>
        <br>

        

        <button type="submit">Lägg till</button>
    </form>

    <h3>Uppgiftslista</h3>
    <ul id="taskList"></ul> <!-- listan där allt kommer vara -->
    

    <script>
        const form = document.getElementById("taskForm");
        const taskList = document.getElementById("taskList");
        const subjectInput = document.getElementById("subject");
        const dueDateInput = document.getElementById("dueDate");
    
        // Räkna ut prioritet baserat på datum
        function getPriority(dueDate) {
            const today = new Date();
            const due = new Date(dueDate);
    
            // Nollställ tid så jämförelsen blir rätt
            today.setHours(0, 0, 0, 0);
            due.setHours(0, 0, 0, 0);
    
            const diffTime = due - today;
            const diffDays = diffTime / (1000 * 60 * 60 * 24);
    
            if (diffDays <= 2) {
                return "high";   // röd
            } else if (diffDays <= 7) {
                return "medium"; // gul
            } else {
                return "low";    // grön
            }
        }
    
        // Ladda uppgifter
        function loadTasks() {
            const saved = localStorage.getItem("tasks");
            return saved ? JSON.parse(saved) : [];
        }
    
        // Spara uppgifter
        function saveTasks(tasks) {
            localStorage.setItem("tasks", JSON.stringify(tasks));
        }
    
        let tasks = loadTasks();
    
        // Lägg till uppgift i listan
        function addTaskToList(task) {
            const li = document.createElement("li");
            li.classList.add(task.priority);
            li.textContent = `${task.subject} - Inlämning: ${task.date}`;
    
            const removeBtn = document.createElement("button");
            removeBtn.textContent = "Ta bort";
            removeBtn.classList.add("remove-btn");
    
            removeBtn.addEventListener("click", () => {
                tasks = tasks.filter(t => t !== task);
                saveTasks(tasks);
                li.remove();
            });
    
            li.appendChild(removeBtn);
            taskList.appendChild(li);
        }
    
        // Visa uppgifter som sparats innan
        tasks.forEach(task => {
            addTaskToList(task);
        });
    
        // formuläret skickas
        form.addEventListener("submit", function(e) {
            e.preventDefault();
    
            const priority = getPriority(dueDateInput.value);
    
            const task = {
                subject: subjectInput.value,
                date: dueDateInput.value,
                priority: priority
            };
    
            tasks.push(task);
            saveTasks(tasks);
            addTaskToList(task);
            form.reset();
        });
    </script>
    
    
</body>
</html>
